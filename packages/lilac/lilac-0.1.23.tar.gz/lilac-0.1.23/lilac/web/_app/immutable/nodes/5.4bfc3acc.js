import{S as ce,i as me,s as _e,k as C,a as L,l as R,m as P,c as A,h as _,n as O,b as $,a0 as T,g as b,v as j,d as I,f as G,O as Q,y as H,z as U,A as W,B as z,q as F,e as X,r as q,u as J,a1 as Z,ab as x,w as ve,U as ke,V as we}from"../chunks/index.6d58eddb.js";import{b as Se,P as $e}from"../chunks/Page.afc73432.js";import{g as Ie}from"../chunks/navigation.1ebbd616.js";import{D as De,R as Te}from"../chunks/DatasetSettingsFields.49546f67.js";import{aI as Ee,aW as Ve,aT as Ne,q as ye,a3 as Ce,a6 as Re,a7 as Pe,aN as Fe,a9 as le,ag as qe,ai as Oe,aj as Be,ak as Le,B as Ae,ac as He,z as Ue,d as We}from"../chunks/Commands.e431ac62.js";import{T as pe}from"../chunks/ToastNotification.0260f333.js";function ae(a){let t,s;return t=new pe({props:{hideCloseButton:!0,kind:"warning",fullWidth:!0,lowContrast:!0,title:"Unknown task",caption:"This could be from a stale link, or a new server instance."}}),{c(){H(t.$$.fragment)},l(e){U(t.$$.fragment,e)},m(e,i){W(t,e,i),s=!0},i(e){s||(b(t.$$.fragment,e),s=!0)},o(e){I(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function ie(a){let t,s,e,i,n,l,r,c,o,g,S,v,p,h,V,d=a[3].status==="error"&&ne(a),f=a[3].status!="error"&&re(a);const m=[Me,ze],k=[];function E(u,w){return u[3].status=="completed"?0:u[3].status==="error"?1:-1}return~(v=E(a))&&(p=k[v]=m[v](a)),{c(){t=C("section"),s=C("div"),e=F('Step 1: Load dataset "'),i=F(a[0]),n=F("/"),l=F(a[1]),r=F('"'),c=L(),o=C("div"),d&&d.c(),g=L(),f&&f.c(),S=L(),p&&p.c(),h=X(),this.h()},l(u){t=R(u,"SECTION",{class:!0});var w=P(t);s=R(w,"DIV",{class:!0});var N=P(s);e=q(N,'Step 1: Load dataset "'),i=q(N,a[0]),n=q(N,"/"),l=q(N,a[1]),r=q(N,'"'),N.forEach(_),c=A(w),o=R(w,"DIV",{class:!0});var y=P(o);d&&d.l(y),y.forEach(_),g=A(w),f&&f.l(w),w.forEach(_),S=A(u),p&&p.l(u),h=X(),this.h()},h(){O(s,"class","text-2xl text-gray-700"),O(o,"class","text-base"),O(t,"class","flex flex-col gap-y-2")},m(u,w){$(u,t,w),T(t,s),T(s,e),T(s,i),T(s,n),T(s,l),T(s,r),T(t,c),T(t,o),d&&d.m(o,null),T(t,g),f&&f.m(t,null),$(u,S,w),~v&&k[v].m(u,w),$(u,h,w),V=!0},p(u,w){(!V||w&1)&&J(i,u[0]),(!V||w&2)&&J(l,u[1]),u[3].status==="error"?d?d.p(u,w):(d=ne(u),d.c(),d.m(o,null)):d&&(d.d(1),d=null),u[3].status!="error"?f?(f.p(u,w),w&8&&b(f,1)):(f=re(u),f.c(),b(f,1),f.m(t,null)):f&&(j(),I(f,1,1,()=>{f=null}),G());let N=v;v=E(u),v===N?~v&&k[v].p(u,w):(p&&(j(),I(k[N],1,1,()=>{k[N]=null}),G()),~v?(p=k[v],p?p.p(u,w):(p=k[v]=m[v](u),p.c()),b(p,1),p.m(h.parentNode,h)):p=null)},i(u){V||(b(f),b(p),V=!0)},o(u){I(f),I(p),V=!1},d(u){u&&_(t),d&&d.d(),f&&f.d(),u&&_(S),~v&&k[v].d(u),u&&_(h)}}}function ne(a){let t,s,e,i;return{c(){t=F("Error loading "),s=F(a[0]),e=F("/"),i=F(a[1])},l(n){t=q(n,"Error loading "),s=q(n,a[0]),e=q(n,"/"),i=q(n,a[1])},m(n,l){$(n,t,l),$(n,s,l),$(n,e,l),$(n,i,l)},p(n,l){l&1&&J(s,n[0]),l&2&&J(i,n[1])},d(n){n&&_(t),n&&_(s),n&&_(e),n&&_(i)}}}function re(a){var r,c;let t,s,e,i,n;s=new Se({props:{labelText:a[3].message||"",helperText:a[3].status!="completed"?a[3].details||void 0:"",value:a[3].status==="completed"?1:a[6],max:1,status:a[16][a[3].status]}});let l=((c=(r=a[5])==null?void 0:r.data)==null?void 0:c.total_num_rows)!=null&&oe(a);return{c(){t=C("div"),H(s.$$.fragment),e=L(),i=C("div"),l&&l.c(),this.h()},l(o){t=R(o,"DIV",{class:!0});var g=P(t);U(s.$$.fragment,g),g.forEach(_),e=A(o),i=R(o,"DIV",{class:!0});var S=P(i);l&&l.l(S),S.forEach(_),this.h()},h(){O(t,"class","mt-2"),O(i,"class","text-sm text-gray-700")},m(o,g){$(o,t,g),W(s,t,null),$(o,e,g),$(o,i,g),l&&l.m(i,null),n=!0},p(o,g){var v,p;const S={};g&8&&(S.labelText=o[3].message||""),g&8&&(S.helperText=o[3].status!="completed"?o[3].details||void 0:""),g&72&&(S.value=o[3].status==="completed"?1:o[6]),g&8&&(S.status=o[16][o[3].status]),s.$set(S),((p=(v=o[5])==null?void 0:v.data)==null?void 0:p.total_num_rows)!=null?l?l.p(o,g):(l=oe(o),l.c(),l.m(i,null)):l&&(l.d(1),l=null)},i(o){n||(b(s.$$.fragment,o),n=!0)},o(o){I(s.$$.fragment,o),n=!1},d(o){o&&_(t),z(s),o&&_(e),o&&_(i),l&&l.d()}}}function oe(a){var i,n;let t=((n=(i=a[5])==null?void 0:i.data)==null?void 0:n.total_num_rows)+"",s,e;return{c(){s=F(t),e=F(" rows loaded")},l(l){s=q(l,t),e=q(l," rows loaded")},m(l,r){$(l,s,r),$(l,e,r)},p(l,r){var c,o;r&32&&t!==(t=((o=(c=l[5])==null?void 0:c.data)==null?void 0:o.total_num_rows)+"")&&J(s,t)},d(l){l&&_(s),l&&_(e)}}}function ze(a){let t,s;return t=new pe({props:{hideCloseButton:!0,kind:"error",fullWidth:!0,lowContrast:!0,title:"Error loading dataset",caption:a[3].error||void 0}}),{c(){H(t.$$.fragment)},l(e){U(t.$$.fragment,e)},m(e,i){W(t,e,i),s=!0},p(e,i){const n={};i&8&&(n.caption=e[3].error||void 0),t.$set(n)},i(e){s||(b(t.$$.fragment,e),s=!0)},o(e){I(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function Me(a){let t,s,e,i,n,l,r,c,o,g,S,v,p,h,V,d=a[2]&&fe(a),f=a[9]!=null&&ue(a);return h=new Ae({props:{disabled:a[2]==null,size:"xl",icon:He,iconDescription:"Open dataset",$$slots:{default:[je]},$$scope:{ctx:a}}}),h.$on("click",a[24]),{c(){t=C("div"),s=C("section"),e=C("div"),i=C("div"),n=F("Step 2: Choose settings"),l=L(),r=C("div"),c=F("These settings can be changed from the dataset page at any time."),o=L(),d&&d.c(),g=L(),S=C("div"),f&&f.c(),v=L(),p=C("div"),H(h.$$.fragment),this.h()},l(m){t=R(m,"DIV",{class:!0});var k=P(t);s=R(k,"SECTION",{class:!0});var E=P(s);e=R(E,"DIV",{class:!0});var u=P(e);i=R(u,"DIV",{class:!0});var w=P(i);n=q(w,"Step 2: Choose settings"),w.forEach(_),l=A(u),r=R(u,"DIV",{class:!0});var N=P(r);c=q(N,"These settings can be changed from the dataset page at any time."),N.forEach(_),u.forEach(_),o=A(E),d&&d.l(E),E.forEach(_),k.forEach(_),g=A(m),S=R(m,"DIV",{});var y=P(S);f&&f.l(y),y.forEach(_),v=A(m),p=R(m,"DIV",{class:!0});var B=P(p);U(h.$$.fragment,B),B.forEach(_),this.h()},h(){O(i,"class","text-2xl text-gray-700"),O(r,"class","text-sm text-gray-500"),O(e,"class","flex flex-col gap-y-2"),O(s,"class","flex flex-col gap-y-4"),O(t,"class","my-8"),O(p,"class","dataset-link mt-8")},m(m,k){$(m,t,k),T(t,s),T(s,e),T(e,i),T(i,n),T(e,l),T(e,r),T(r,c),T(s,o),d&&d.m(s,null),$(m,g,k),$(m,S,k),f&&f.m(S,null),$(m,v,k),$(m,p,k),W(h,p,null),V=!0},p(m,k){m[2]?d?(d.p(m,k),k&4&&b(d,1)):(d=fe(m),d.c(),b(d,1),d.m(s,null)):d&&(j(),I(d,1,1,()=>{d=null}),G()),m[9]!=null?f?(f.p(m,k),k&512&&b(f,1)):(f=ue(m),f.c(),b(f,1),f.m(S,null)):f&&(j(),I(f,1,1,()=>{f=null}),G());const E={};k&4&&(E.disabled=m[2]==null),k&67108864&&(E.$$scope={dirty:k,ctx:m}),h.$set(E)},i(m){V||(b(d),b(f),b(h.$$.fragment,m),V=!0)},o(m){I(d),I(f),I(h.$$.fragment,m),V=!1},d(m){m&&_(t),d&&d.d(),m&&_(g),m&&_(S),f&&f.d(),m&&_(v),m&&_(p),z(h)}}}function fe(a){let t,s,e;function i(l){a[23](l)}let n={namespace:a[0],datasetName:a[1]};return a[2]!==void 0&&(n.newSettings=a[2]),t=new De({props:n}),ve.push(()=>ke(t,"newSettings",i)),{c(){H(t.$$.fragment)},l(l){U(t.$$.fragment,l)},m(l,r){W(t,l,r),e=!0},p(l,r){const c={};r&1&&(c.namespace=l[0]),r&2&&(c.datasetName=l[1]),!s&&r&4&&(s=!0,c.newSettings=l[2],we(()=>s=!1)),t.$set(c)},i(l){e||(b(t.$$.fragment,l),e=!0)},o(l){I(t.$$.fragment,l),e=!1},d(l){z(t,l)}}}function ue(a){let t,s,e,i,n;return i=new Te({props:{rowId:a[9],mediaFields:a[7],highlightedFields:a[8]}}),{c(){t=C("div"),s=F("Preview"),e=L(),H(i.$$.fragment),this.h()},l(l){t=R(l,"DIV",{class:!0});var r=P(t);s=q(r,"Preview"),r.forEach(_),e=A(l),U(i.$$.fragment,l),this.h()},h(){O(t,"class","text-xl text-gray-700")},m(l,r){$(l,t,r),T(t,s),$(l,e,r),W(i,l,r),n=!0},p(l,r){const c={};r&512&&(c.rowId=l[9]),r&128&&(c.mediaFields=l[7]),r&256&&(c.highlightedFields=l[8]),i.$set(c)},i(l){n||(b(i.$$.fragment,l),n=!0)},o(l){I(i.$$.fragment,l),n=!1},d(l){l&&_(t),l&&_(e),z(i,l)}}}function je(a){let t;return{c(){t=F("Save and open dataset")},l(s){t=q(s,"Save and open dataset")},m(s,e){$(s,t,e)},d(s){s&&_(t)}}}function Ge(a){let t,s,e,i,n=a[4].isSuccess&&a[3]==null&&ae(),l=a[3]&&ie(a);return{c(){t=C("div"),s=C("div"),n&&n.c(),e=L(),l&&l.c(),this.h()},l(r){t=R(r,"DIV",{class:!0});var c=P(t);s=R(c,"DIV",{class:!0});var o=P(s);n&&n.l(o),e=A(o),l&&l.l(o),o.forEach(_),c.forEach(_),this.h()},h(){O(s,"class","center-panel mx-auto p-8 svelte-af9918"),O(t,"class","w-full overflow-y-scroll")},m(r,c){$(r,t,c),T(t,s),n&&n.m(s,null),T(s,e),l&&l.m(s,null),i=!0},p(r,[c]){r[4].isSuccess&&r[3]==null?n?c&24&&b(n,1):(n=ae(),n.c(),b(n,1),n.m(s,e)):n&&(j(),I(n,1,1,()=>{n=null}),G()),r[3]?l?(l.p(r,c),c&8&&b(l,1)):(l=ie(r),l.c(),b(l,1),l.m(s,null)):l&&(j(),I(l,1,1,()=>{l=null}),G())},i(r){i||(b(n),b(l),i=!0)},o(r){I(n),I(l),i=!1},d(r){r&&_(t),n&&n.d(),l&&l.d()}}}function Je(a,t,s){let e,i,n,l,r,c,o,g,S,v,p,h,V=Z,d=()=>(V(),V=x(i,D=>s(20,h=D)),i),f,m=Z,k=()=>(m(),m=x(n,D=>s(21,f=D)),n),E,u,w=Z,N=()=>(w(),w=x(l,D=>s(5,u=D)),l);a.$$.on_destroy.push(()=>V()),a.$$.on_destroy.push(()=>m()),a.$$.on_destroy.push(()=>w());let{namespace:y}=t,{datasetName:B}=t,{loadingTaskId:K}=t,M;const ee=Ee();Q(a,ee,D=>s(25,v=D));const Y=Ve(y,B);Q(a,Y,D=>s(22,E=D)),Ne(Y);const te=ye();Q(a,te,D=>s(4,p=D));const ge={pending:"active",completed:"finished",error:"error"};function se(){M!=null&&v.mutate([y,B,M],{onSuccess:()=>{Ie(Ue(y,B))}})}function he(D){M=D,s(2,M)}const be=()=>se();return a.$$set=D=>{"namespace"in D&&s(0,y=D.namespace),"datasetName"in D&&s(1,B=D.datasetName),"loadingTaskId"in D&&s(18,K=D.loadingTaskId)},a.$$.update=()=>{a.$$.dirty&262160&&s(3,g=K!=null&&p.data!=null?p.data.tasks[K]:null),a.$$.dirty&8&&s(19,e=(g==null?void 0:g.status)=="completed"),a.$$.dirty&524291&&d(s(12,i=e?Ce(y,B):null)),a.$$.dirty&4718595&&k(s(11,n=e?Re(y,B,Pe(E)):null)),a.$$.dirty&1048579&&N(s(10,l=y&&B&&(h==null?void 0:h.data)!=null?Fe(y,B,{columns:[le],limit:1,combine_columns:!0},h.data):null)),a.$$.dirty&32&&s(9,r=(u==null?void 0:u.data)!=null?Oe.value(Be(u.data.rows[0],[le]),"string"):null),a.$$.dirty&6291456&&s(8,c=qe(E.query,f==null?void 0:f.data)),a.$$.dirty&1048580&&s(7,o=M!=null&&(h==null?void 0:h.data)!=null?Le(h==null?void 0:h.data,M):[]),a.$$.dirty&8&&s(6,S=(g==null?void 0:g.step_progress)==null?void 0:g.step_progress)},[y,B,M,g,p,u,S,o,c,r,l,n,i,ee,Y,te,ge,se,K,e,h,f,E,he,be]}class Ke extends ce{constructor(t){super(),me(this,t,Je,Ge,_e,{namespace:0,datasetName:1,loadingTaskId:18})}}function de(a){let t,s;return t=new Ke({props:{namespace:a[0],datasetName:a[1],loadingTaskId:a[2]}}),{c(){H(t.$$.fragment)},l(e){U(t.$$.fragment,e)},m(e,i){W(t,e,i),s=!0},p(e,i){const n={};i&1&&(n.namespace=e[0]),i&2&&(n.datasetName=e[1]),i&4&&(n.loadingTaskId=e[2]),t.$set(n)},i(e){s||(b(t.$$.fragment,e),s=!0)},o(e){I(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function Qe(a){let t,s,e=a[0]!=null&&a[1]!=null&&a[2]!=null&&de(a);return{c(){e&&e.c(),t=X()},l(i){e&&e.l(i),t=X()},m(i,n){e&&e.m(i,n),$(i,t,n),s=!0},p(i,n){i[0]!=null&&i[1]!=null&&i[2]!=null?e?(e.p(i,n),n&7&&b(e,1)):(e=de(i),e.c(),b(e,1),e.m(t.parentNode,t)):e&&(j(),I(e,1,1,()=>{e=null}),G())},i(i){s||(b(e),s=!0)},o(i){I(e),s=!1},d(i){e&&e.d(i),i&&_(t)}}}function Xe(a){let t,s;return t=new $e({props:{$$slots:{default:[Qe]},$$scope:{ctx:a}}}),{c(){H(t.$$.fragment)},l(e){U(t.$$.fragment,e)},m(e,i){W(t,e,i),s=!0},p(e,[i]){const n={};i&39&&(n.$$scope={dirty:i,ctx:e}),t.$set(n)},i(e){s||(b(t.$$.fragment,e),s=!0)},o(e){I(t.$$.fragment,e),s=!1},d(e){z(t,e)}}}function Ye(a,t,s){let e,i,n,l;const r=We();return Q(a,r,c=>s(4,e=c)),a.$$.update=()=>{a.$$.dirty&16&&e.page==="datasets/loading"&&e.identifier!=null&&s(0,[i,n,l]=e.identifier.split("/"),i,(s(1,n),s(4,e)),(s(2,l),s(4,e)))},[i,n,l,r,e]}class at extends ce{constructor(t){super(),me(this,t,Ye,Xe,_e,{})}}export{at as component};
