"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[4093],{1301:(o,e,r)=>{r.d(e,{Z:()=>n,m:()=>a});var t=r(8373);const i={space:"6px",spaceArrow:"10px",arrowOffset:"10px",arrowOffsetVertical:"10px",arrowHeight:"6px",padding:"8px 14px"},a=o=>{const{boxShadow2:e,popoverColor:r,textColor2:t,borderRadius:a,fontSize:n,dividerColor:s}=o;return Object.assign(Object.assign({},i),{fontSize:n,borderRadius:a,color:r,dividerColor:s,textColor:t,boxShadow:e})},n={name:"Popover",common:t.Z,self:a}},6919:(o,e,r)=>{r.d(e,{Z:()=>a,m:()=>i});var t=r(8373);const i=o=>{const{infoColor:e,successColor:r,warningColor:t,errorColor:i,textColor2:a,progressRailColor:n,fontSize:s,fontWeight:l}=o;return{fontSize:s,fontSizeCircle:"28px",fontWeightCircle:l,railColor:n,railHeight:"8px",iconSizeCircle:"36px",iconSizeLine:"18px",iconColor:e,iconColorInfo:e,iconColorSuccess:r,iconColorWarning:t,iconColorError:i,textColorCircle:a,textColorLineInner:"rgb(255, 255, 255)",textColorLineOuter:a,fillColor:e,fillColorInfo:e,fillColorSuccess:r,fillColorWarning:t,fillColorError:i,lineBgProcessing:"linear-gradient(90deg, rgba(255, 255, 255, .3) 0%, rgba(255, 255, 255, .5) 100%)"}},a={name:"Progress",common:t.Z,self:i}},7918:(o,e,r)=>{r.d(e,{Z:()=>t});const t={padding:"8px 14px"}},838:(o,e,r)=>{r.d(e,{Z:()=>l});var t=r(8373),i=r(1301),a=r(7918),n=r(5103),s=r(5944);const l=(0,n.j)({name:"Tooltip",common:t.Z,peers:{Popover:i.Z},self:o=>{const{borderRadius:e,boxShadow2:r,baseColor:t}=o;return Object.assign(Object.assign({},a.Z),{borderRadius:e,boxShadow:r,color:(0,s.h$)(t,"rgba(0, 0, 0, .85)"),textColor:t})}})},7032:(o,e,r)=>{r.d(e,{Z:()=>d,m:()=>l});var t=r(5944),i=r(6403),a=r(6919),n=r(8373),s=r(5103);const l=o=>{const{iconColor:e,primaryColor:r,errorColor:i,textColor2:a,successColor:n,opacityDisabled:s,actionColor:l,borderColor:d,hoverColor:c,lineHeight:u,borderRadius:g,fontSize:p}=o;return{fontSize:p,lineHeight:u,borderRadius:g,draggerColor:l,draggerBorder:`1px dashed ${d}`,draggerBorderHover:`1px dashed ${r}`,itemColorHover:c,itemColorHoverError:(0,t.zX)(i,{alpha:.06}),itemTextColor:a,itemTextColorError:i,itemTextColorSuccess:n,itemIconColor:e,itemDisabledOpacity:s,itemBorderImageCardError:`1px solid ${i}`,itemBorderImageCard:`1px solid ${d}`}},d=(0,s.j)({name:"Upload",common:n.Z,peers:{Button:i.Z,Progress:a.Z},self:l})},5106:(o,e,r)=>{r.r(e),r.d(e,{default:()=>W});var t=r(6252),i=r(9963);const a={class:"card"},n={class:"card-body"},s=(0,t._)("h1",null,"Organisation Information",-1),l=(0,t._)("br",null,null,-1),d=["href"],c=(0,t._)("hr",null,null,-1),u={class:"row"},g=(0,t._)("div",{class:"col-md-4"},[(0,t._)("strong",null,"Please Note"),(0,t._)("p",{class:"text-instructions"}," Please only use generic information for both the website and email. Do not use any personal details - you can create contacts in the section below. ")],-1),p={class:"col-md-3"},m=["src"],h=(0,t._)("br",null,null,-1),f={class:"col-md-5"},_={class:"form-group"},b={for:"id_organisation_name"},C=(0,t._)("br",null,null,-1),v={class:"form-group"},w={for:"id_organisation_website"},x=(0,t._)("br",null,null,-1),E={class:"form-group"},M={for:"id_organisation_email"},y=(0,t._)("br",null,null,-1),S={key:0},$={key:1,class:"row submit-row"},P={class:"col-md-12"};var k=r(9729),I=r(4344),T=r(989),U=r(5705),O=r(760),R=r(7939),L=r(3058),Z=r(8416),N=r(106);const B={name:"OrganisationInformation",setup:()=>({v$:(0,U.ZP)()}),components:{NButton:k.ZP,NUpload:I.Z,ValidationRendering:R.Z},props:{organisationResults:{type:Array,default:()=>[]}},mixins:[L.Z,N.Z,Z.Z],computed:{...(0,T.Se)({rootUrl:"getRootUrl",staticUrl:"getStaticUrl",userLevel:"getUserLevel"})},data(){return{organisationNameModel:this.organisationResults[0].fields.organisation_name,organisationEmailModel:this.organisationResults[0].fields.organisation_email,organisationWebsiteModel:this.organisationResults[0].fields.organisation_website,profilePicture:""}},validations:{organisationNameModel:{required:O.C1,maxLength:(0,O.BS)(255)},organisationWebsiteModel:{required:O.C1,url:O.HQ},organisationEmailModel:{required:O.C1,email:O.Do}},methods:{showErrorToast(){this.$store.dispatch("newToast",{header:"Error uploading profile picture",message:"Sorry, we had an issue uploading the profile image.",extra_classes:"bg-danger",delay:0})},setProfilePicture(){let o=this.organisationResults[0].fields.organisation_profile_picture;this.profilePicture=null!=o&&""!==o?`${this.rootUrl}private/${o}`:`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`},updateOrganisation(){if(this.v$.$touch(),this.v$.$invalid)return void this.showValidationErrorModal();const o=new FormData;o.set("organisation_name",this.organisationNameModel),o.set("organisation_email",this.organisationEmailModel),o.set("organisation_website",this.organisationWebsiteModel),this.showLoadingModal("Organisation"),this.axios.post(`${this.rootUrl}organisation_information/${this.organisationResults[0].pk}/save/`,o).then((o=>{this.closeLoadingModal()})).catch((o=>{this.showErrorModal(o,"organisation",this.organisationResults[0].pk)}))},updateProfilePicture(){this.$store.dispatch("newToast",{header:"Profile Picture updated",message:"Good news - profile picture updated",extra_classes:"bg-success",unique_type:"update_profile",delay:0}),this.axios.post(`${this.rootUrl}organisation_information/${this.organisationResults[0].pk}/get_profile_picture/`).then((o=>{this.profilePicture=o.data,this.$store.dispatch("newToast",{header:"Profile Picture updated",message:"Good news - profile picture updated",extra_classes:"bg-success",unique_type:"update_profile"})})).catch((o=>{this.profilePicture=`${this.staticUrl}/NearBeach/images/placeholder/product_tour.svg`,this.$store.dispatch("newToast",{header:"Error uploading profile picture",message:`Sorry, we had an issue uploading the profile image. Error -> ${o}`,extra_classes:"bg-danger",delay:0})}))}},mounted(){this.setProfilePicture()}},W=(0,r(3744).Z)(B,[["render",function(o,e,r,k,I,T){const U=(0,t.up)("n-button"),O=(0,t.up)("n-upload"),R=(0,t.up)("validation-rendering");return(0,t.wg)(),(0,t.iD)("div",a,[(0,t._)("div",n,[(0,t.kq)(" TITLE "),s,l,(0,t._)("a",{href:`${o.rootUrl}search/organisation/`},"Back to organisation search",8,d),c,(0,t.kq)(" FIELDS SECTION "),(0,t._)("div",u,[g,(0,t._)("div",p,[(0,t._)("img",{src:I.profilePicture,alt:"Profile Picture",class:"organisation-profile-image"},null,8,m),h,(0,t.kq)('<button class="btn btn-primary">Update Profile...</button>'),o.userLevel>1?((0,t.wg)(),(0,t.j4)(O,{key:0,action:`${o.rootUrl}organisation_information/${r.organisationResults[0].pk}/update_profile/`,headers:{"X-CSRFTOKEN":o.getToken("csrftoken")},data:{},onFinish:T.updateProfilePicture,onError:T.showErrorToast},{default:(0,t.w5)((()=>[(0,t.Wm)(U,null,{default:(0,t.w5)((()=>[(0,t.Uk)("Update Profile Picture")])),_:1})])),_:1},8,["action","headers","onFinish","onError"])):(0,t.kq)("v-if",!0)]),(0,t._)("div",f,[(0,t.kq)(" ORGANISATION NAME "),(0,t._)("div",_,[(0,t._)("label",b,[(0,t.Uk)(" Organisation Name "),(0,t.Wm)(R,{"error-list":k.v$.organisationNameModel.$errors},null,8,["error-list"])]),(0,t.wy)((0,t._)("input",{id:"id_organisation_name","onUpdate:modelValue":e[0]||(e[0]=o=>I.organisationNameModel=o),type:"text",class:"form-control"},null,512),[[i.vModelText,I.organisationNameModel]])]),C,(0,t.kq)(" ORGANISATION WEBSITE "),(0,t._)("div",v,[(0,t._)("label",w,[(0,t.Uk)(" Organisation Website "),(0,t.Wm)(R,{"error-list":k.v$.organisationWebsiteModel.$errors},null,8,["error-list"])]),(0,t.wy)((0,t._)("input",{id:"id_organisation_website","onUpdate:modelValue":e[1]||(e[1]=o=>I.organisationWebsiteModel=o),type:"text",class:"form-control"},null,512),[[i.vModelText,I.organisationWebsiteModel]])]),x,(0,t.kq)(" ORGANISATION EMAIL "),(0,t._)("div",E,[(0,t._)("label",M,[(0,t.Uk)(" Organisation Email "),(0,t.Wm)(R,{"error-list":k.v$.organisationWebsiteModel.$errors},null,8,["error-list"])]),(0,t.wy)((0,t._)("input",{id:"id_organisation_email","onUpdate:modelValue":e[2]||(e[2]=o=>I.organisationEmailModel=o),type:"text",class:"form-control"},null,512),[[i.vModelText,I.organisationEmailModel]])])])]),y,(0,t.kq)(" NEED TO APPLY PERMISSIONS "),(0,t.kq)(" Submit Button "),o.userLevel>1?((0,t.wg)(),(0,t.iD)("hr",S)):(0,t.kq)("v-if",!0),o.userLevel>1?((0,t.wg)(),(0,t.iD)("div",$,[(0,t._)("div",P,[(0,t._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:e[3]||(e[3]=(...o)=>T.updateOrganisation&&T.updateOrganisation(...o))},"Update Organisation")])])):(0,t.kq)("v-if",!0)])])}]])},7939:(o,e,r)=>{r.d(e,{Z:()=>n});var t=r(6252),i=r(3577);const a={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},n=(0,r(3744).Z)(a,[["render",function(o,e,r,a,n,s){return(0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.errorList,(o=>((0,t.wg)(),(0,t.iD)("span",{class:"error",key:o.$uid},(0,i.toDisplayString)(o.$message),1)))),128)}]])},3058:(o,e,r)=>{r.d(e,{Z:()=>i});var t=r(3138);const i={methods:{showErrorModal(o,e,r){const i=document.getElementById("loadingModal");if(null===i)return;new t.u_(i).hide();const a=document.getElementById("errorModalContent");if(void 0===a)return;if(a.innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${e}-${r}<hr>${o}`,null===document.getElementById("errorModal"))return;const n=new t.u_(n);n.show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new t.u_(document.getElementById("errorModal")).show()}}}},106:(o,e,r)=>{r.d(e,{Z:()=>t});const t={methods:{getToken(o){const e=new RegExp(`${o}=([^;]+)`).exec(document.cookie);return null!==e?encodeURIComponent(e[1]):null}}}},8416:(o,e,r)=>{r.d(e,{Z:()=>i});var t=r(3138);const i={methods:{closeLoadingModal(){const o=new t.u_(document.getElementById("loadingModal"));document.getElementById("loadingModalContent").innerHTML="UPDATED SUCCESSFULLY",setTimeout((()=>{o.hide()}),1e3)},showLoadingModal(o){new t.u_(document.getElementById("loadingModal")).show(),document.getElementById("loadingModalContent").innerHTML=`Updating your ${o} details`}}}}}]);