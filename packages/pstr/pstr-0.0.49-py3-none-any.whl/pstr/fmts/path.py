# AUTOGENERATED! DO NOT EDIT! File to edit: ../../nbs/03_fmts/04_path.ipynb.

# %% auto 0
__all__ = ['RichText', 'format_base_path', 'format_rich_path', 'fmtpath']

# %% ../../nbs/03_fmts/04_path.ipynb 4
from typing import Union, Optional, TypeAlias, ForwardRef
from pathlib import Path

# %% ../../nbs/03_fmts/04_path.ipynb 5
from ..enum.tree import TreeStr
from ..nchr.core import SPACE
from ..nlit.byte import (BYTE_ABRVS as UNITS, BYTE, BYTES)
from .byte import fmtbyte

# %% ../../nbs/03_fmts/04_path.ipynb 7
RichText: TypeAlias = ForwardRef('rich.text.Text')

# %% ../../nbs/03_fmts/04_path.ipynb 8
def format_base_path(
    path: Path, prefix: str = '', treestr: TreeStr = TreeStr.TEE, suffix: str = '',
    link: Optional[bool] = False, size: Optional[bool] = False,
) -> str:
    pstr = prefix
    tstr = treestr or TreeStr.TEE
    lstr = ' file://' if link else ''
    nstr = path.name
    sstr = suffix
    bstr = f' ({fmtbyte(path.stat().st_size)})' if size else ''
    return f'{pstr}{tstr}{lstr}{nstr}{bstr}{sstr}'

def format_rich_path(path: Path) -> Optional[RichText]:
    from rich.text import Text
    text = Text(path.name)
    size = fmtbyte(path.stat().st_size)
    text.stylize(f'link file://{path}')
    text.append(f' ({size})', 'cyan')
    return text

# %% ../../nbs/03_fmts/04_path.ipynb 9
def fmtpath(
    path: Path, 
    prefix: str = '',
    treestr: Optional['TreeStr'] = None,
    suffix: str = '', 
    link: Optional[bool] = False, 
    size: Optional[bool] = False
) -> Union[RichText, str]:
    try: return format_rich_path(path)
    except ImportError: return format_base_path(path, prefix, treestr, suffix, link, size)
